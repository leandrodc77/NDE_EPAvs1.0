<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>OSCE/EPA ‚Äì Leitor de PDF ‚Üí Checklist + Devolutiva</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>html, body { height: 100%; }</style>
</head>
<body class="min-h-screen bg-gradient-to-b from-white via-blue-50/30 to-white text-gray-900">
  <div id="root"></div>

  <!-- React + Babel (sem build) -->
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- PDF.js (vers√£o compat√≠vel com UMD/global window.pdfjsLib) -->
  <script src="https://unpkg.com/pdfjs-dist@2.16.105/build/pdf.min.js"></script>
  <script>
    // Worker correto (mesma vers√£o do PDF.js)
    if (window.pdfjsLib) {
      pdfjsLib.GlobalWorkerOptions.workerSrc =
        "https://unpkg.com/pdfjs-dist@2.16.105/build/pdf.worker.min.js";
    }
  </script>

  <!-- Mammoth (DOCX ‚Üí texto) -->
  <script src="https://unpkg.com/mammoth/mammoth.browser.min.js"></script>

  <script type="text/babel">
    const { useState, useMemo, useEffect } = React;

    /* ================= UI ================= */
    const clsJoin = (...xs) => xs.filter(Boolean).join(" ");
    function Button({ children, onClick, variant="primary", className="", type="button", disabled=false }) {
      const base = "inline-flex items-center justify-center rounded-2xl px-4 py-2 text-sm font-medium border transition focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-60 disabled:cursor-not-allowed";
      const styles = {
        primary: "bg-blue-600 text-white border-blue-700 enabled:hover:bg-blue-700 focus:ring-blue-600",
        secondary: "bg-white text-gray-900 border-gray-300 enabled:hover:bg-gray-50 focus:ring-gray-400",
        ghost: "bg-transparent text-gray-700 border-transparent enabled:hover:bg-gray-100 focus:ring-gray-300",
      };
      return <button type={type} onClick={onClick} disabled={disabled} className={clsJoin(base, styles[variant], className)}>{children}</button>;
    }
    const Card = ({ children, className="" }) => <div className={clsJoin("rounded-3xl border border-gray-200 bg-white/80 backdrop-blur shadow-sm", className)}>{children}</div>;
    const CardContent = ({ children, className="" }) => <div className={className}>{children}</div>;
    const SummaryStat = ({ label, value }) => (
      <div className="rounded-2xl border border-gray-200 bg-white px-3 py-3">
        <div className="text-xs uppercase tracking-wide text-gray-500 mb-1">{label}</div>
        <div className="text-base font-semibold text-gray-900">{value}</div>
      </div>
    );
    const ProgressBar = ({ value }) => {
      const clamped = Math.max(0, Math.min(100, value || 0));
      return (
        <div className="w-full h-2 bg-gray-200 rounded-full overflow-hidden">
          <div className="h-full bg-blue-600 transition-all" style={{ width: clamped + "%" }} />
        </div>
      );
    };
    const ErrorBanner = ({ error, onClose }) => !error ? null : (
      <div className="fixed bottom-4 left-4 right-4 z-50">
        <div className="mx-auto max-w-3xl rounded-2xl border border-rose-200 bg-rose-50 text-rose-800 p-3 text-sm shadow">
          <div className="flex items-start gap-3">
            <strong>Erro:</strong>
            <div className="flex-1 whitespace-pre-wrap">{String(error)}</div>
            <button className="text-rose-700" onClick={onClose} aria-label="Fechar">‚úï</button>
          </div>
        </div>
      </div>
    );

    /* ================= Extra√ß√£o de arquivos ================= */
    async function extractPdfText(file) {
      if (!window.pdfjsLib) throw new Error("PDF.js n√£o carregou. Verifique conex√£o/CDN.");
      const buffer = await file.arrayBuffer();
      const pdf = await pdfjsLib.getDocument({ data: buffer }).promise;
      let fullText = "";
      for (let p = 1; p <= pdf.numPages; p++) {
        const page = await pdf.getPage(p);
        const content = await page.getTextContent();
        fullText += content.items.map(it => it.str).join(" ") + "\n";
      }
      return fullText.trim();
    }
    async function extractDocxText(file) {
      if (!window.mammoth) throw new Error("Mammoth (DOCX) n√£o carregou.");
      const buffer = await file.arrayBuffer();
      const res = await window.mammoth.extractRawText({ arrayBuffer: buffer });
      return (res.value || "").trim();
    }

    /* ================= Heur√≠sticas ================= */
    const DEFAULT_SECTIONS = [
      {
        id: "diagnostico",
        title: "Avalia√ß√£o diagn√≥stica",
        description: "Classifique gravidade e apresente crit√©rios utilizados.",
        items: [
          { id: "classificacao", title: "Classifica√ß√£o do quadro",
            options: [
              { value: "ok",  label: "Reconhece quadro grave quando presente", score: 2,
                feedback: "Reconhecimento √°gil dos sinais de gravidade, direcionando a conduta inicial com seguran√ßa." },
              { value: "par", label: "Classifica como moderado", score: 1,
                feedback: "Boa percep√ß√£o, mas faltar lapidar crit√©rios de gravidade para prioriza√ß√£o adequada." },
              { value: "no",  label: "Classifica como leve/ausente frente a sinais de alerta", score: 0,
                feedback: "Subestima√ß√£o do risco; revise os indicadores de gravidade para evitar atrasos cr√≠ticos." },
            ]},
          { id: "criterios", title: "Crit√©rios diagn√≥sticos citados",
            options: [
              { value: "ok",  label: "Cita crit√©rios completos e corretos", score: 2,
                feedback: "Crit√©rios essenciais foram contemplados, garantindo avalia√ß√£o abrangente." },
              { value: "par", label: "Cita parcialmente", score: 1,
                feedback: "Citou parte dos crit√©rios; revisar indicadores mandat√≥rios para precis√£o diagn√≥stica." },
              { value: "no",  label: "Insuficiente/incorreto", score: 0,
                feedback: "Crit√©rios insuficientes; requer refor√ßo conceitual e treino supervisionado." },
            ]},
        ],
      },
      {
        id: "conduta",
        title: "Conduta inicial",
        description: "Decis√µes assistenciais imediatas.",
        items: [
          { id: "local", title: "Local de cuidado",
            options: [
              { value: "ok",  label: "Indica interna√ß√£o/monitoriza√ß√£o quando indicado", score: 2,
                feedback: "Decis√£o adequada √† severidade, priorizando seguran√ßa do paciente." },
              { value: "par", label: "Observa√ß√£o em menor complexidade", score: 1,
                feedback: "Cautela v√°lida, mas cen√°rios graves pedem interna√ß√£o para vigil√¢ncia cont√≠nua." },
              { value: "no",  label: "Define manejo ambulatorial em cen√°rio de risco", score: 0,
                feedback: "Inadequado ao risco; revise protocolos de seguran√ßa na tomada de decis√£o." },
            ]},
        ],
      },
      {
        id: "prescricao",
        title: "Plano terap√™utico",
        description: "Estrutura do plano e justificativa.",
        items: [
          { id: "plano", title: "Estrutura do plano",
            options: [
              { value: "ok",  label: "Plano completo (fases/tempos/volumes ou passos)", score: 2,
                feedback: "Plano bem estruturado e seguro, com etapas definidas." },
              { value: "par", label: "Plano parcial", score: 1,
                feedback: "Aponta a etapa principal; detalhe fases e tempos para precis√£o." },
              { value: "no",  label: "Plano n√£o aderente ao recomendado", score: 0,
                feedback: "Fora do protocolo; revisar diretrizes e par√¢metros." },
            ]},
          { id: "just", title: "Escolha terap√™utica e justificativa",
            options: [
              { value: "ok",  label: "Condiz com protocolo e justificativa clara", score: 2,
                feedback: "Escolha alinhada ao protocolo institucional, com racional expl√≠cito." },
              { value: "par", label: "Escolha citada sem especificidade", score: 1,
                feedback: "Justificativa pouco espec√≠fica; alinhar escolha a crit√©rios cl√≠nicos." },
              { value: "no",  label: "Escolha n√£o indicada para o quadro", score: 0,
                feedback: "Rever indica√ß√µes, riscos e alternativas." },
            ]},
        ],
      },
      {
        id: "orientacao",
        title: "Comunica√ß√£o e orienta√ß√£o",
        description: "Orienta√ß√µes ao paciente/fam√≠lia e seguran√ßa.",
        items: [
          { id: "edu", title: "Orienta√ß√µes fornecidas",
            options: [
              { value: "ok",  label: "Completas (sinais de alarme, retorno, cuidados)", score: 2,
                feedback: "Orienta√ß√µes claras e completas, refor√ßando seguran√ßa e ades√£o." },
              { value: "par", label: "Parciais", score: 1,
                feedback: "Incluiu parte das orienta√ß√µes; complementar sinais de alarme e retorno." },
              { value: "no",  label: "Inadequadas/ausentes", score: 0,
                feedback: "Faltaram orienta√ß√µes essenciais; isso compromete seguran√ßa e seguimento." },
            ]},
        ],
      },
    ];

    function topKeywords(text, n=8) {
      if (!text) return [];
      const stop = new Set(["de","da","do","das","dos","a","o","e","em","no","na","nos","nas","um","uma","para","com","por","que","se","ao","os","as","ou","como","√©","s√£o","foi","ser","sem","mais","menos","quando","onde","qual","quais","sobre"]);
      const tokens = text.toLowerCase().replace(/[^\p{L}\p{N}\s]/gu," ").split(/\s+/)
        .filter(t => t.length >= 4 && !stop.has(t));
      const f = {}; tokens.forEach(t => f[t]=(f[t]||0)+1);
      return Object.entries(f).sort((a,b)=>b[1]-a[1]).slice(0,n).map(([k])=>k);
    }
    const pickTitleFromText = (t) => {
      if (!t) return "Prova OSCE/EPA ‚Äì Esta√ß√£o (defina pelo PDF)";
      const lines = t.split(/\n+/).map(s=>s.trim()).filter(Boolean);
      const hit = lines.find(l => /EPA|Esta√ß√£o|Atividade Profissional Confi√°vel/i.test(l)) || lines[0];
      return (hit || "Prova OSCE/EPA ‚Äì Esta√ß√£o").slice(0,140);
    };
    const generateSectionsFromText = (text) => {
      const kws = topKeywords(text, 10);
      const clone = JSON.parse(JSON.stringify(DEFAULT_SECTIONS));
      if (kws.length) clone[0].description += ` (palavras‚Äëchave: ${kws.join(", ")})`;
      return clone;
    };

    /* ================= Componentes ================= */
    function ChecklistOptionButton({ option, selected, onSelect }) {
      const base = "w-full text-left border rounded-2xl px-4 py-3 text-sm transition shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2";
      const active = selected ? "border-blue-600 bg-blue-50 text-blue-900 focus:ring-blue-500"
                              : "border-gray-200 bg-white hover:border-blue-400 hover:bg-blue-50/60 focus:ring-blue-400";
      const TAGS = {
        2: "bg-emerald-50 text-emerald-700 border border-emerald-200",
        1: "bg-amber-50 text-amber-700 border border-amber-200",
        0: "bg-rose-50 text-rose-700 border border-rose-200",
      };
      const label = selected?.score === 2 ? "Realizado corretamente" : selected?.score === 1 ? "Parcial" : selected ? "N√£o realizado" : "";
      return (
        <button type="button" className={clsJoin(base, active)} onClick={onSelect}>
          <div className="flex flex-col gap-2 md:flex-row md:items-start md:justify-between">
            <span className="font-medium">{option.label}</span>
            {selected && <span className={clsJoin("inline-flex items-center rounded-xl px-3 py-1 text-xs font-medium", TAGS[selected.score])}>{label}</span>}
          </div>
        </button>
      );
    }
    function ChecklistItem({ item, selectedOption, onSelect }) {
      return (
        <div className="space-y-3">
          <h3 className="text-sm font-semibold text-gray-900">{item.title}</h3>
          <div className="grid gap-2">
            {item.options.map((opt) => (
              <ChecklistOptionButton
                key={opt.value}
                option={opt}
                selected={selectedOption?.value === opt.value ? opt : null}
                onSelect={() => onSelect(item.id, opt)}
              />
            ))}
          </div>
        </div>
      );
    }
    function ChecklistSection({ section, responses, onSelect }) {
      return (
        <Card className="border-0 shadow">
          <CardContent className="p-6 md:p-8 space-y-6">
            <div className="space-y-2">
              <h2 className="text-lg font-semibold text-gray-900">{section.title}</h2>
              {section.description && <p className="text-sm text-gray-600">{section.description}</p>}
            </div>
            <div className="space-y-6">
              {section.items.map((item) => (
                <ChecklistItem key={item.id} item={item} selectedOption={responses[item.id]} onSelect={onSelect} />
              ))}
            </div>
          </CardContent>
        </Card>
      );
    }
    function CaseImage({ src, onPick }) {
      return (
        <Card className="border-0 shadow">
          <CardContent className="p-6 md:p-8 space-y-4">
            <div className="flex items-center justify-between">
              <div>
                <h2 className="text-lg font-semibold text-gray-900">Imagem do cen√°rio (opcional)</h2>
                <p className="text-sm text-gray-600">Fotografia cl√≠nica, fluxograma, quadro, etc.</p>
              </div>
              <input type="file" accept="image/*" className="text-sm"
                onChange={(e) => {
                  const f = e.target.files?.[0]; if (!f) return;
                  const r = new FileReader();
                  r.onload = ev => onPick(ev.target.result);
                  r.readAsDataURL(f);
                }} />
            </div>
            <div className="aspect-video w-full overflow-hidden rounded-2xl bg-gray-100 border flex items-center justify-center">
              {src ? <img src={src} alt="Imagem do cen√°rio" className="w-full h-full object-contain" /> : <span className="text-xs text-gray-500">Nenhuma imagem selecionada.</span>}
            </div>
          </CardContent>
        </Card>
      );
    }

    /* ================= Devolutiva ================= */
    const OVERALL = {
      high:  { label: "Desempenho competente",        badge: "border-emerald-200 bg-emerald-50 text-emerald-800", closing: "Condu√ß√£o alinhada √†s melhores pr√°ticas; mantenha atualiza√ß√£o e clareza na comunica√ß√£o." },
      medium:{ label: "Parcialmente competente",      badge: "border-amber-200 bg-amber-50 text-amber-800",       closing: "Refor√ßar crit√©rios de gravidade e estrutura do plano; praticar explica√ß√£o das condutas." },
      low:   { label: "Necessita desenvolvimento",    badge: "border-rose-200 bg-rose-50 text-rose-800",          closing: "Rever crit√©rios, plano e orienta√ß√µes; atuar sob supervis√£o pr√≥xima." },
    };
    function buildFeedback(sections, responses) {
      const ALL_ITEMS = sections.flatMap(s => s.items);
      const entries = ALL_ITEMS.map(it => ({ it, sel: responses[it.id] })).filter(e => e.sel);
      const strengths = entries.filter(e => e.sel.score === 2).map(e => "‚Ä¢ " + e.sel.feedback);
      const inProg    = entries.filter(e => e.sel.score === 1).map(e => "‚Ä¢ " + e.sel.feedback);
      const improv    = entries.filter(e => e.sel.score === 0).map(e => "‚Ä¢ " + e.sel.feedback);
      const total = ALL_ITEMS.length;
      const sum = entries.reduce((a,e)=>a+(e.sel.score||0),0);
      const ratio = total ? sum/(total*2) : 0;
      const level = ratio>=0.75 ? OVERALL.high : ratio>=0.45 ? OVERALL.medium : OVERALL.low;
      const text = [
        "Devolutiva estruturada a partir do checklist:",
        strengths.length ? "üü¢ Pontos fortes\n"+strengths.join("\n") : "",
        inProg.length    ? "üü° Aspectos em consolida√ß√£o\n"+inProg.join("\n") : "",
        improv.length    ? "üî¥ Oportunidades de aprimoramento\n"+improv.join("\n") : "",
        level.closing
      ].filter(Boolean).join("\n\n");
      return { text, ratio, level };
    }

    /* ================= Source Loader ================= */
    function SourceLoader({ sourceText, setSourceText, scenarioTitle, setScenarioTitle, setSections, setError }) {
      const [busy, setBusy] = useState(false);
      const [fileName, setFileName] = useState("");

      async function onFile(file) {
        if (!file) return;
        setBusy(true); setFileName(file.name); setError("");
        try {
          let text = "";
          if (file.name.toLowerCase().endsWith(".pdf")) text = await extractPdfText(file);
          else if (file.name.toLowerCase().endsWith(".docx")) text = await extractDocxText(file);
          else throw new Error("Formato n√£o suportado. Use PDF ou DOCX.");
          setSourceText(text);
          setScenarioTitle(pickTitleFromText(text));
        } catch (e) {
          console.error(e);
          setError(e.message || "Falha ao ler arquivo.");
        } finally {
          setBusy(false);
        }
      }
      function build() {
        if (!sourceText) { setError("Sem texto: carregue um PDF/DOCX ou cole o conte√∫do."); return; }
        setSections(generateSectionsFromText(sourceText));
      }

      return (
        <Card className="border-0 shadow">
          <CardContent className="p-6 md:p-8 space-y-4">
            <div className="flex items-center justify-between gap-3">
              <div>
                <h2 className="text-lg font-semibold text-gray-900">1) Carregar cen√°rio (PDF ou DOCX)</h2>
                <p className="text-sm text-gray-600">O texto √© extra√≠do no navegador e usado para sugerir o checklist.</p>
              </div>
              <input type="file" accept=".pdf,.docx" className="text-sm"
                onChange={(e) => onFile(e.target.files?.[0])} />
            </div>
            {fileName && <p className="text-xs text-gray-500">Arquivo: {fileName} {busy ? "‚Äî lendo‚Ä¶" : ""}</p>}

            <div className="grid gap-3">
              <label className="text-xs text-gray-600">T√≠tulo da esta√ß√£o</label>
              <input type="text" className="rounded-xl border border-gray-300 px-3 py-2 text-sm"
                value={scenarioTitle} onChange={(e)=>setScenarioTitle(e.target.value)} />
            </div>

            <div className="space-y-2">
              <div className="flex items-center justify-between gap-2">
                <label className="text-xs text-gray-600">Pr√©‚Äëvisualiza√ß√£o/edi√ß√£o do texto extra√≠do</label>
                <Button variant="secondary" onClick={build} disabled={!sourceText || busy}>Gerar checklist</Button>
              </div>
              <textarea className="w-full min-h-[160px] rounded-2xl border border-gray-200 p-3 text-sm"
                value={sourceText} onChange={(e)=>setSourceText(e.target.value)}
                placeholder="Carregue um PDF/DOCX ou cole o texto do cen√°rio aqui‚Ä¶" />
            </div>
          </CardContent>
        </Card>
      );
    }

    /* ================= App ================= */
    function App() {
      const [scenarioTitle, setScenarioTitle] = useState("Prova OSCE/EPA ‚Äì Esta√ß√£o (defina pelo PDF)");
      const [sourceText, setSourceText] = useState("");
      const [sections, setSections] = useState(DEFAULT_SECTIONS);
      const [responses, setResponses] = useState({});
      const [caseImage, setCaseImage] = useState(null);
      const [showFeedback, setShowFeedback] = useState(false);
      const [copyMsg, setCopyMsg] = useState("");
      const [error, setError] = useState("");

      const ALL_ITEMS = useMemo(() => sections.flatMap(s => s.items), [sections]);
      const totalItems = ALL_ITEMS.length;
      const answeredCount = Object.keys(responses).length;
      const answeredScore = useMemo(() => Object.values(responses).reduce((s, opt) => s + (opt?.score || 0), 0), [responses]);
      const completion = totalItems ? answeredCount / totalItems : 0;
      const { text: feedbackText, ratio, level } = useMemo(() => buildFeedback(sections, responses), [sections, responses]);
      const canGenerate = answeredCount === totalItems;

      const onSelect = (id, opt) => { setResponses(prev => ({ ...prev, [id]: opt })); setShowFeedback(false); };
      const onGenerate = () => { if (canGenerate) setShowFeedback(true); };
      const onReset = () => { setResponses({}); setShowFeedback(false); setCopyMsg(""); };
      const onCopy = async () => {
        if (!feedbackText) return;
        try { await navigator.clipboard.writeText(feedbackText); setCopyMsg("Texto copiado."); }
        catch { setCopyMsg("Falha ao copiar automaticamente."); }
        setTimeout(()=>setCopyMsg(""), 2500);
      };

      // Captura erros JS globais para evitar "tela branca"
      useEffect(() => {
        const handler = (ev) => setError(ev?.message || "Erro desconhecido de execu√ß√£o.");
        window.addEventListener("error", handler);
        return () => window.removeEventListener("error", handler);
      }, []);

      return (
        <div className="min-h-screen p-4 md:p-8">
          <div className="max-w-6xl mx-auto space-y-6">
            <header className="flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
              <div className="space-y-1">
                <h1 className="text-2xl md:text-3xl font-bold text-gray-900">{scenarioTitle}</h1>
                <p className="text-sm text-gray-600 max-w-3xl">Carregue PDF/DOCX ‚Üí gere checklist ‚Üí marque os itens ‚Üí gere devolutiva.</p>
              </div>
              <div className="flex items-center gap-2 text-sm text-gray-500">
                <span className="inline-flex h-10 w-10 items-center justify-center rounded-full bg-blue-100 text-blue-700 font-semibold">OSCE</span>
                <div>
                  <p className="font-medium text-gray-700">Esta√ß√£o</p>
                  <p>EPA/OSCE com base no arquivo</p>
                </div>
              </div>
            </header>

            <div className="grid gap-6 lg:grid-cols-[2fr,1fr]">
              <div className="space-y-6">
                <SourceLoader
                  sourceText={sourceText}
                  setSourceText={setSourceText}
                  scenarioTitle={scenarioTitle}
                  setScenarioTitle={setScenarioTitle}
                  setSections={setSections}
                  setError={setError}
                />
                <CaseImage src={caseImage} onPick={setCaseImage} />
                {sections.map((section) => (
                  <ChecklistSection key={section.id} section={section} responses={responses} onSelect={onSelect} />
                ))}
              </div>

              <div className="space-y-6">
                <Card className="border-0 shadow">
                  <CardContent className="p-6 md:p-8 space-y-5">
                    <div>
                      <h2 className="text-lg font-semibold text-gray-900">Resumo</h2>
                      <p className="text-sm text-gray-600">Progresso do preenchimento.</p>
                    </div>
                    <div className="grid grid-cols-2 gap-3">
                      <SummaryStat label="Crit√©rios respondidos" value={`${answeredCount}/${totalItems}`} />
                      <SummaryStat label="Conclus√£o" value={`${Math.round(completion * 100)}%`} />
                      <SummaryStat label="Pontua√ß√£o" value={answeredScore} />
                      <SummaryStat label="Percentual final" value={answeredCount ? `${Math.round(ratio * 100)}%` : "‚Äî"} />
                    </div>
                    {answeredCount > 0 && (
                      <div className={clsJoin("rounded-2xl px-3 py-3", level.badge)}>
                        <div className="text-xs uppercase tracking-wide">Classifica√ß√£o</div>
                        <div className="text-base font-semibold">{level.label}</div>
                      </div>
                    )}
                    <ProgressBar value={completion * 100} />
                  </CardContent>
                </Card>

                <Card className="border-0 shadow">
                  <CardContent className="p-6 md:p-8 space-y-4">
                    <h2 className="text-lg font-semibold text-gray-900">A√ß√µes r√°pidas</h2>
                    <div className="flex flex-col gap-2">
                      <Button onClick={onGenerate} disabled={!canGenerate}>Gerar devolutiva</Button>
                      <Button variant="secondary" onClick={onReset} disabled={answeredCount === 0}>Limpar sele√ß√£o</Button>
                      <Button variant="secondary" onClick={() => window.print()}>Imprimir</Button>
                      <Button variant="ghost" onClick={onCopy} disabled={!feedbackText}>Copiar texto</Button>
                    </div>
                    {!canGenerate && (
                      <p className="text-xs text-gray-500">Responda todos os {totalItems} crit√©rios para liberar a devolutiva autom√°tica.</p>
                    )}
                    {copyMsg && <p className="text-xs text-gray-500">{copyMsg}</p>}
                  </CardContent>
                </Card>

                <Card className="border-0 shadow">
                  <CardContent className="p-6 md:p-8 space-y-4">
                    <div className="flex items-center justify-between gap-3">
                      <div>
                        <h2 className="text-lg font-semibold text-gray-900">Devolutiva</h2>
                        <p className="text-sm text-gray-600">Gerada a partir das marca√ß√µes do checklist.</p>
                      </div>
                      <Button variant="secondary" onClick={onCopy} disabled={!feedbackText}>Copiar</Button>
                    </div>
                    <div className="rounded-2xl border border-gray-200 bg-gray-50 p-4 text-sm leading-relaxed text-gray-800 whitespace-pre-line min-h-[220px]">
                      {showFeedback ? feedbackText : "Selecione todos os crit√©rios e clique em ‚ÄúGerar devolutiva‚Äù."}
                    </div>
                  </CardContent>
                </Card>
              </div>
            </div>
          </div>

          <ErrorBanner error={error} onClose={() => setError("")} />
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<App />);
  </script>
</body>
</html>
